## Легенда

В команду тестирования пришла задача: необходимо протестировать оплату зарубежных сервисов.
Запрос на оплату формируется пользователем на frontend и содержит наименование провайдера, сумму и дату.
Cумма вводится в валюте получателя платежа, а итоговая сумма рассчитывается в рублях в зависимости от курса ЦБ.
Известно, что на текущий момент, нашей платёжной системе, запрещено выполнять платёж на сумму более 15000р.

## Описание решения

Решение представляет из себя gRPC-сервер с единственной функцией ProcessPayment
1) На входе:
  - имя провайдера (строка)
  - сумма платежа в формате дробного числа и кода валюты, разделенных пробелом (строка)
  - дата в формате _02.01.2006 - второе января 2006 года_ (строка)

2) На выходе:
  - информация о том, принят ли платеж (bool)
  - id (целое число, в случае корректной обработки транзакция записывается в БД), _опциональное поле_
  - сообщение о принятии транзакции в обработку с указанием суммы платежа в рублях, либо сообщение об ошибке

_.proto файл находится в папке mock_payment_

При обработке платежа проверяется корректность вводных данных (**логика проверки описана в payment_server/internal/validator.go**).
Информация о корректных запросах записывается в БД (_имя провайдера, сумма платежа в рублях (округленная до копеек), дата платежа_).
Записи в БД существуют 10 минут, после чего удаляются.

Также был написан простейший клиент, который отправляет тестовые сообщения на сервер и логирует ответы.

### Технические детали

Решение собирается в виде Docker-приложения.
БД - PostgreSQL.
Приложение должно потянуть сотни параллельно запускаемых тестов, т.к. gRPC-сервер обрабатывает каждый запрос в отдельной горутине,
а для PostgreSQL выставлено максимум 100 одновременных соединений.


БД, сервер, клиент в виде отдельных контейнеров.

### Предлагаемая последовательность команд для запуска
1) docker-compose up postgres -d         **Запустить БД**
2) docker-compose logs postgres          **Проверить логи БД, запустилась ли** (я не заморочился и оставил подключение к БД примитивным, без ретраев)
3) docker-compose up payment-server -d   **Запустить сервер**
4) docker-compose logs payment-server    **Проверить логи сервера**
5) docker-compose up payment-client -d   **Запустить клиента**
6) docker-compose logs payment-client    **Проверить логи с ответами на тестовые данные**
